<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <title>
      
        Project Proposal - Visual Relationship Detection
      
    </title>
    <meta name="viewport" content="width=device-width">
    <link rel="stylesheet" href="/assets/css/normalize.css">
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/syntax.css">
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
      <script src="/assets/js/respond.min.js"></script>
    <![endif]-->

  </head>
  <body>
    <div class="container">
      <header role="banner">
        <div class="wrap">
          
          <h1 class="site-title"><a class="title-link" href="/">Visual Relationship Detection</a></h1>
        </div>
      </header>

      <div class="wrap content">

        <aside>
  <p class="intro">Term Project for CS 6476 - Computer Vision </p>
  <br />
  <p> Authors: Arvind Krishnakumar, Asawaree Bhide, Divyansh Roy, Shubhangi Upasani </p>
  <a class="skip-link visuallyhidden focusable" href="#main">Skip to Main Content</a>
  <nav class="sidebar-nav" role="navigation">
    <ul>
      
        
          <li><a href="/./">Home</a></li>
        
      
        
          <li><a href="/proposal/">Proposal</a></li>
        
      
        
          <li><a href="https://github.com/akrishna77/houghlepuff">houghlepuff Repo</a></li>
        
      
    </ul>
  </nav>
</aside>

        <section id="main" class="main-content" role="main">
          <h2 class="page-title">Project Proposal</h2>

<h3 id="problem-statement">Problem Statement</h3>

<p>The objective of this project is to detect objects of interest in a given image and highlight the relationships between these objects. Almost all real-world objects have visual relationships between them. The input to the system is an image along with a textual description of an object-object relationship and the output is the image with bounding boxes around the objects that correspond to the textual input. The output would also include a scene graph representing all object-object relationships in the image. For instance, given an input “person on a skateboard”, the system would give as output:</p>

<h3 id="approach">Approach</h3>

<p>Input to the system will be a textual description in the form of a triplet ‘(subject, predicate, object)’ for instance, ‘laptop on desk’. The objective is to produce bounding boxes around the objects involved in the relationship. The model to achieve the same is described in the subsequent sections.</p>

<p>Training phase, 
	1.1. The first step is to find all object pairs in training images using object detection algorithms like RCNN, fast RCNN or YOLO. So, an image with a cowboy riding a horse gives object pairs like ‘cowboy and horse’, ‘cowboy and hat’, ‘horse and saddle’ etc.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1.2. Visual module - After finding all possible object pairs from the training data, the next step is to find the possibility of the detected object pairs belonging to the corresponding ground truth relationship label, which is of the form &lt;i,j,k&gt; where i and k are object classes and j is the predicate. Only one type of detected object pairs (that have the relationship as specified by the ground truth) will have the highest probability of belonging to the label. This is achieved by training CNN classifiers. 

1.3 Language module - This module finds word embeddings of the detected objects and the matching relationship and projects them to common vector space as a relationship vector. After this, similar relationship vectors are found between different object-predicate-object triplets. This is done to match never-seen-before relationships like ‘man riding an elephant’ to the ones already encountered like ‘man riding horse’. 
</code></pre></div></div>

<p>Testing phase
	Given a test image and a textual description of a visual relationship between two objects, the task is to detect these objects in the image and use the visual and language modules to learn appropriate features that match the relationship specified through the textual description. Spatial filtering is also performed between the detected object pairs to eliminate unlikely pairs that don’t have meaningful relationship between them. –example??. As output, the object pairs that best match the relationship specified are highlighted with bounding boxes in the image.</p>

<p>Tasks:
	Object detection: make bounding boxes around all entities in the image that look like the ‘subject’ and the ‘object’ given in the input description.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Object pair filtering: A neural network to filter out object pairs in the image that do not have a visibly meaningful relationship between them (spatially distant objects).

Model: based on the positions of these bounding boxes with respect to each other, detect if the relationship corresponding to the input predicate exists between the entities in question.
</code></pre></div></div>

<h3 id="experiments--evaluation">Experiments &amp; Evaluation</h3>

<p>For implementation, we use Python 3.x version and keras or PyTorch framework with required libraries. 
Dataset used- We use the Visual Relationship Dataset which has 5000 images with 100 object categories and 70 predicates. In total, it has 37,993 relationships and 6,672 relationship types. The relationships have been classified into many categories, some of which are action, preposition, comparative, verb etc.  Some examples of relationships included in the dataset are  ‘person kick ball’, ‘person on top of ramp’, ‘motorcycle with wheel’, ‘man riding horse’ etc.</p>

<p>We may use bits of existing code from the following projects-</p>

<p>https://github.com/pjreddie/darknet/wiki/YOLO:-Real-Time-Object-Detection (for detecting object pairs)</p>

<p>https://github.com/matterport/Mask_RCNN (for detecting object pairs)</p>

<p>https://github.com/yikang-li/vg_cleansing (for creating the language module)</p>

<p>https://github.com/jz462/Large-Scale-VRD.pytorch (for visual relationship understanding)</p>

<p>https://github.com/doubledaibo/drnet_cvpr2017 (for visual relationship detection[2])</p>

<p>https://github.com/GriffinLiang/vrd-dsr (for visual relationship detection[3])</p>

<p>The existing implementations for visual relationship detection output all possible object-object relationships when fed a test image. We intend to detect specific object pairs and a relationship predicate between them that match the given textual input while at the same time try and minimize the number of erroneous pairs our model outputs.</p>

<p>A specific case we want to handle is as follows:
Given an input ‘man holding pen’ and an image where there is a man and a pen lying on the notebook next to him, our system should not display bounding boxes around the man or the pen because there is no ‘holding’ relationship. As another example, for the image below, the input ‘man on horse’ should correctly ignore the man walking in front of the horse. This relationship should be discarded during the filtering stage.</p>

<p>We use recall (the percentage of total relevant results correctly classified by our system) (the ability of our model to find all the relevant cases within the dataset) as a performance metric. This is to account for the possibility that some object-object relationships may not have been seen during the training phase.</p>

<p>We will test our model on two datasets: VRD and SVG.</p>

<p>If our model correctly displays bounding boxes with an acceptable precision, we’ll consider it a success. We expect to exploit the correlation between visual and language cues of an image to find accurate visual relationships. We also wish to experiment with how spatial context of objects and the relationships they are involved in differ. For example, a ‘man riding a horse’ and ‘man standing next to a horse’ have the same objects - ‘man’ and ‘horse’ with similar context and spatial features, yet the relationships between them are different.</p>

<h3 id="references">References</h3>

<ol>
  <li>Cewu Lu, Ranjay Krishna, Michael Bernstein and Li Fei-Fei “Visual Relationship Detection with Language Priors”</li>
  <li>Bo Dai, Yuqi Zhang and Dahua Lin “Detecting Visual Relationships with Deep Relational Networks”</li>
  <li>Kongming Liang, Yuhong Guo, Hong Chang and Xilin Chen “Visual Relationship Detection with Deep Structural Ranking” In The Thirty-Second AAAI Conference on Artificial Intelligence (AAAI-18)</li>
  <li>Stephan Baier, Yunpu Ma, and Volker Tresp “Improving Visual Relationship Detection usingSemantic Modeling of Scene Descriptions”</li>
</ol>



        </section>

      </div><!-- /.wrap content -->

      <footer role="contentinfo">
        <div class="wrap">
          <p>This project is maintained by <a href="http://github.com/akrishna77">Arvind</a>.</p>

          <p>Hosted on <a href="http://pages.github.com/">GitHub Pages</a>.</p>
        </div><!--/.wrap -->
      </footer>
    </div> <!-- /.container -->
    
    </body>
</html>
